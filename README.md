# ECG_analysis

In this repository I've presented a little example on how to work with ECG recordings. In the colab notebook uploaded an example of the code as well as the pipeline followed can be observed. 
I've also uploaded a .html report extracted from the database generated.

The main topics that I've worked in have been:
* Database extraction from the .hea files

|    | Patient    |    age |  sex   |  ECG date   |  Diagnose   |  Reason for admission   |  Acute infarction (localization)   |  Former infarction (localization)   |  Additional diagnoses   |  Smoker   |  Number of coronary vessels involved   |  Infarction date (acute)   |  Previous infarction (1) date   |  Previous infarction (2) date   |  Hemodynamics   |  Catheterization date   |  Ventriculography                    |  Chest X-ray   |  Peripheral blood Pressure (syst/diast)   |  Pulmonary artery pressure (at rest) (syst/diast)   |  Pulmonary artery pressure (at rest) (mean)   |  Pulmonary capillary wedge pressure (at rest)   |  Cardiac output (at rest)   |  Cardiac index (at rest)   |  Stroke volume index (at rest)   |  Pulmonary artery pressure (laod) (syst/diast)   |  Pulmonary artery pressure (laod) (mean)   |  Pulmonary capillary wedge pressure (load)   |  Cardiac output (load)   |  Cardiac index (load)   |  Stroke volume index (load)   |  Aorta (at rest) (syst/diast)   |  Aorta (at rest) mean   |  Left ventricular enddiastolic pressure   |  Left coronary artery stenoses (RIVA)   |  Left coronary artery stenoses (RCX)   |  Right coronary artery stenoses (RCA)              |  Echocardiography   |  Therapy   |  Infarction date   |  Catheterization date   |  Admission date   |  Medication pre admission   |  Start lysis therapy (hh.mm)   |  Lytic agent   |  Dosage (lytic agent)   |  Additional medication                          |  In hospital medication   |  Medication after discharge   |
|---:|:-----------|-------:|:-------|:------------|:------------|:------------------------|:-----------------------------------|:------------------------------------|:------------------------|:----------|:---------------------------------------|:---------------------------|:--------------------------------|:--------------------------------|:----------------|:------------------------|:-------------------------------------|:---------------|:------------------------------------------|:----------------------------------------------------|:----------------------------------------------|:------------------------------------------------|:----------------------------|:---------------------------|:---------------------------------|:-------------------------------------------------|:-------------------------------------------|:---------------------------------------------|:-------------------------|:------------------------|:------------------------------|:--------------------------------|:------------------------|:------------------------------------------|:----------------------------------------|:---------------------------------------|:---------------------------------------------------|:--------------------|:-----------|:-------------------|:------------------------|:------------------|:----------------------------|:-------------------------------|:---------------|:------------------------|:------------------------------------------------|:--------------------------|:------------------------------|
|  0 | patient122 |     68 | male   | 21/07/1992  |             | Healthy control         | no                                 | no                                  | no                      | unknown   | unknown                                | n/a                        | n/a                             | n/a                             |                 | n/a                     | n/a                                  | n/a            | n/a                                       | n/a                                                 | n/a                                           | n/a                                             | n/a                         | n/a                        | n/a                              | n/a                                              | n/a                                        | n/a                                          | n/a                      | n/a                     | n/a                           | n/a                             | n/a                     | n/a                                       | n/a                                     | n/a                                    | n/a                                                | n/a                 |            | n/a                | n/a                     | n/a               | n/a                         | n/a                            | n/a            | n/a                     | n/a                                             | n/a                       | n/a                           |
|  0 | patient206 |     32 | male   | 05/03/1996  |             | Bundle branch block     | no                                 | no                                  | Tinnitus                | no        | unknown                                | n/a                        | n/a                             | n/a                             |                 | n/a                     | n/a                                  | n/a            | n/a                                       | n/a                                                 | n/a                                           | n/a                                             | n/a                         | n/a                        | n/a                              | n/a                                              | n/a                                        | n/a                                          | n/a                      | n/a                     | n/a                           | n/a                             | n/a                     | n/a                                       | n/a                                     | n/a                                    | n/a                                                | no Echo             |            | n/a                | n/a                     | n/a               | n/a                         | n/a                            | n/a            | n/a                     | n/a                                             | n/a                       | n/a                           |
|  0 | patient065 |     52 | male   | 18/09/1991  |             | Myocardial infarction   | infero-postero-lateral             | no                                  | no                      | no        | 1                                      | 13-Sep-91                  | n/a                             | n/a                             |                 | 23-Sep-91               | Akinesia infero-postero-lateral wall | normal         | 110/70 mmHg                               | 25/10 cmH2O                                         | 16 cmH2O                                      | 21 cmH2O                                        | 7,55 l/min                  | 3,1 l/min/sqrmBSA          | 47.0 ml/beat                     | 58/24 cmH2O                                      | 40 cmH2O                                   | 30 cmH2O                                     | 12,96 l/min              | 5,9 l/min/sqrmBSA       | 54,5 ml/beat                  | n/a                             | n/a                     | n/a                                       | No stenoses                             | No stenoses                            | RCA proximal to ramus ventricularis posterior 100% | n/a                 |            | 13-Sep-91          | 23-Sep-91               | 13-Sep-91         | -                           | 08:45                          | Gamma-TPA      | 100 mg                  | ASA Metoprolol Isosorbit-Mononitrate Molsidomin | ASA                       | ASA ACE-Hemmer                |
|  0 | patient065 |     52 | male   | 20/09/1991  |             | Myocardial infarction   | infero-postero-lateral             | no                                  | no                      | no        | 1                                      | 13-Sep-91                  | n/a                             | n/a                             |                 | 23-Sep-91               | Akinesia infero-postero-lateral wall | normal         | 110/70 mmHg                               | 25/10 cmH2O                                         | 16 cmH2O                                      | 21 cmH2O                                        | 7,55 l/min                  | 3,1 l/min/sqrmBSA          | 47.0 ml/beat                     | 58/24 cmH2O                                      | 40 cmH2O                                   | 30 cmH2O                                     | 12,96 l/min              | 5,9 l/min/sqrmBSA       | 54,5 ml/beat                  | n/a                             | n/a                     | n/a                                       | No stenoses                             | No stenoses                            | RCA proximal to ramus ventricularis posterior 100% | n/a                 |            | 13-Sep-91          | 23-Sep-91               | 13-Sep-91         | -                           | 08:45                          | Gamma-TPA      | 100 mg                  | ASA Metoprolol Isosorbit-Mononitrate Molsidomin | ASA                       | ASA ACE-Hemmer                |
|  0 | patient065 |     52 | male   | 25/03/1992  |             | Myocardial infarction   | infero-postero-lateral             | no                                  | no                      | no        | 1                                      | 13-Sep-91                  | n/a                             | n/a                             |                 | 23-Sep-91               | Akinesia infero-postero-lateral wall | normal         | 110/70 mmHg                               | 25/10 cmH2O                                         | 16 cmH2O                                      | 21 cmH2O                                        | 7,55 l/min                  | 3,1 l/min/sqrmBSA          | 47.0 ml/beat                     | 58/24 cmH2O                                      | 40 cmH2O                                   | 30 cmH2O                                     | 12,96 l/min              | 5,9 l/min/sqrmBSA       | 54,5 ml/beat                  | n/a                             | n/a                     | n/a                                       | No stenoses                             | No stenoses                            | RCA proximal to ramus ventricularis posterior 100% | n/a                 |            | 13-Sep-91          | 23-Sep-91               | 13-Sep-91         | -                           | 08:45                          | Gamma-TPA      | 100 mg                  | ASA Metoprolol Isosorbit-Mononitrate Molsidomin | ASA                       | ASA ACE-Hemmer                |

* Loading recording with the wtdb package
![Reading](example_of_recording_reading.png)
* Processing recordings sequentally by bandpass filtering, derivative filtering, squaring and integration
![Processing](example_steps.png)
* Detection of QRS complexes
![QRS_1](Example_of_QRS_detection.png)
![QRS_2](Example_of_QRS_detection_0.png)

* Extracting RR, QR , RS and QRS measurements and poincaré plots

|    | Patient    |   Heart Rate |   Heart Beats |   Average_RR_interval(ms) |    SDRR |   QR_interval |   RS_interval |   QRS_time |
|---:|:-----------|-------------:|--------------:|--------------------------:|--------:|--------------:|--------------:|-----------:|
|  0 | patient122 |      66.3915 |           127 |                   903.73  | 39.0889 |       34.1732 |       27.5433 |    61.7165 |
|  1 | patient065 |      72.5018 |           139 |                   827.565 | 20.1087 |       48.4892 |       27.9065 |    76.3957 |
|  2 | patient065 |      70.4814 |           136 |                   851.289 | 44.8669 |       39.8162 |       41.1765 |    80.9926 |
|  3 | patient065 |      54.5917 |           105 |                  1099.07  | 82.9388 |       60.5048 |       29.3238 |    89.8286 |

![QRS_1](Example_poincaré_1.png)
![QRS_2](Example_poincaré_2.png)
* Report: I've prepared a .html report with a summary of the db that you can access by downloading it and opening from your browser
[click here](DB_analysis.html)
* Future steps
  * Adding different amplitude and frequency features such as and computing them from the segmented QRS complexes {| DF1 | DF2 | H/L ratio | Deciles [D1–D9] | SMR	Binary Lempel-Ziv | Multistate Lempel-Ziv (n = 6) | Sample entropy | Spectral entropy | Fuzzy entropy | Time reversibility | SD1 | SD2 | SD1/SD2 | FFT dominant frequencies| }
  * Studying differences between patients with different diagnosis and different extracted features to find out the most discriminative ones for example visually with boxplots per category or more mathematically by using parametric and non-parametrics significance tests
  
